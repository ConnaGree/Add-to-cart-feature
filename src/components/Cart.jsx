import React from "react";
import { useState, useEffect } from "react";

const Cart = ({ cartItems, removeCartItem, updateQuantity }) => {
  const [prodCounter, setProdCounter] = useState(0); // Controls the total number of products in the cart

  // Whenever there is a change in the cartItems array
  // calculate the total number of items in the cart and update the state variable tracking the numbers
  useEffect(() => {
    const totalQuantity = cartItems.reduce(
      (total, item) => total + item.quantity,
      0
    );
    setProdCounter(totalQuantity);
  }, [cartItems]);

  return (
    <div className="cart">
      <h2 className="top_c">
        Cart
        <div className="num_items">
          <div className="total__items-inner"></div>
          <svg
            className="cart__svg"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 1024 1024"
            id="cart"
            fill="#e74c3c"
          >
            <path d="M63.2 161h164.7c-9.6-7.3-19.3-14.7-28.9-22 4.8 14.6 9.6 29.2 14.4 43.9 11.6 35.1 23.1 70.2 34.7 105.3C262 330.4 276 372.7 289.9 415c12.1 36.7 24.2 73.4 36.2 110.1 5.9 17.8 11.5 35.7 17.6 53.4.1.3.2.5.3.8 4.9 14.9 21 26.1 36.9 21 14.8-4.8 26.2-20.9 21-36.9-4.8-14.6-9.6-29.2-14.4-43.9-11.6-35.1-23.1-70.2-34.7-105.3-13.9-42.3-27.8-84.6-41.8-126.9-12.1-36.7-24.2-73.4-36.2-110.1-5.9-17.8-11.4-35.7-17.6-53.4-.1-.3-.2-.5-.3-.8-4.2-12.6-15.3-22-28.9-22H63.3c-15.7 0-30.7 13.8-30 30 .6 16.3 13.1 30 29.9 30z"></path>
            <path d="M347 556.1c-16.2 28.9-32.5 57.7-48.7 86.6-2.3 4.2-4.7 8.3-7 12.5-11.1 19.7 2.9 45.1 25.9 45.1h458c21.1 0 42.3.4 63.5 0h.9c15.7 0 30.7-13.8 30-30-.7-16.3-13.2-30-30-30h-458c-21.1 0-42.4-.6-63.5 0h-.9c8.6 15 17.3 30.1 25.9 45.1 16.2-28.9 32.5-57.7 48.7-86.6 2.3-4.2 4.7-8.3 7-12.5 7.7-13.7 3.7-33.4-10.8-41-14.2-7.4-32.8-3.8-41 10.8z"></path>
            <circle cx="746.5" cy="824.9" r="68.1"></circle>
            <path d="M658.4 824.9c.4 37.5 23.9 69.9 58.8 83 33 12.4 73.6 1.6 96.1-25.6 23.9-29 28.7-70.3 8.8-102.9-19.6-32.2-57.2-47.9-93.9-40.7-40.5 7.9-69.4 45.6-69.8 86.2-.1 10.5 9.3 20.5 20 20 10.9-.5 19.9-8.8 20-20 0-1.6.1-3.3.2-4.9 0-.7.1-1.4.2-2.1.3-4-.1 1.3-.2 1.2-.7-.4 2.1-9 2.4-9.8.3-.8.9-4.2 1.6-4.4.2-.1-1.8 3.7-.7 1.7.4-.8.8-1.6 1.1-2.4 1.5-3 3.3-5.7 5.1-8.5 1.9-2.9-2.7 3.1.5-.6 1-1.1 2-2.3 3.1-3.4s2.2-2.2 3.3-3.2c.5-.4 1-.9 1.5-1.3.7-.6 3.6-2 1-.9-2.2.9-.6.5.1 0s1.4-1 2.2-1.5c1.1-.7 2.2-1.4 3.4-2 1.5-.9 3.1-1.6 4.7-2.4.5-.3 2.6-1.3 0-.1-3 1.4 1-.3 1.3-.4 2.7-1 5.6-1.8 8.4-2.4.9-.2 1.8-.3 2.7-.5 2.2-.5-1.9.2-1.9.2 1.8 0 3.7-.4 5.5-.4 3.3-.1 6.5 0 9.8.3 3.7.3-3.8-.7.8.2 1.8.3 3.5.8 5.3 1.2 1.5.4 3 .9 4.5 1.4.4.1 2.4.8 2.5.9.1.3-3.7-1.9-1.7-.7 2.8 1.7 5.9 3 8.7 4.8.7.5 1.4 1 2.2 1.5.7.5 2.2.9.1 0-2-.8-.7-.6 0 .1.7.6 1.3 1.1 2 1.7 2.5 2.2 4.6 4.6 6.8 7 3 3.3-1.4-2.3.5.6.8 1.3 1.7 2.5 2.5 3.8.8 1.3 1.6 2.7 2.3 4l.9 1.8c1.9 3.6.4-.3-.1-.5 1.2.4 2.5 7.6 2.9 8.9.3 1.3.6 2.7.9 4 .8 3.8-.1-1.2-.1-1.3.5.5.3 2.8.3 3.4.2 3 .2 6.1 0 9.1-.1.9-.2 1.8-.2 2.8-.1 2-1.2 1.7.2-1.2-.7 1.5-.7 3.7-1.1 5.3-.7 2.8-1.8 5.5-2.6 8.3-.8 2.5 1.8-3.4.5-1.1-.3.5-.6 1.2-.8 1.8-.8 1.6-1.6 3.1-2.5 4.6-.8 1.3-1.6 2.6-2.5 3.9-2.7 4.1 1.9-2-.4.7-2.2 2.5-4.3 4.9-6.8 7.1-.4.4-2.8 3-3.5 3 0 0 4.1-2.8.9-.8-.6.4-1.1.7-1.6 1.1-2.8 1.8-5.7 3.3-8.6 4.8-3.1 1.6 3.6-1.2-.7.3-1.5.5-2.9 1-4.4 1.5-1.5.4-3 .8-4.6 1.2-.7.1-1.3.3-2 .4-4.4 1 3.2-.2.6 0-3.3.3-6.5.5-9.8.4-1.6 0-3.2-.2-4.9-.3-.6 0-3-.3-.1 0 3.3.3-.7-.2-1.4-.3-3.5-.7-6.9-1.8-10.3-3-.6-.2-2.6-1.2-.1 0 2.9 1.4-.6-.3-1.2-.6-1.6-.8-3.1-1.6-4.6-2.5-1.5-.9-2.9-1.9-4.4-2.9-2.4-1.5.3.8.9.8-.4 0-1.7-1.4-2-1.7-2.6-2.3-5.1-4.7-7.4-7.4 0 0-1.7-1.7-1.7-2 0 .4 2.4 3.4.8.9-1-1.5-2-2.9-2.9-4.4-1-1.7-1.9-3.5-2.8-5.2-2.1-4.1 1 3.2-.6-1.3-1.2-3.4-2.2-6.8-2.9-10.4-.1-.6-.1-1.5-.4-2 1.5 3.3.3 2.8.1.5-.2-2.1-.3-4.2-.3-6.3-.1-10.5-9.1-20.5-20-20-11.2.3-20.6 8.7-20.5 19.9z"></path>
            <circle cx="401.8" cy="824.9" r="68.1"></circle>
            <path d="M313.7 824.9c.4 37.5 23.9 69.9 58.8 83 33 12.4 73.6 1.6 96.1-25.6 23.9-29 28.7-70.3 8.8-102.9-19.6-32.2-57.2-47.9-93.9-40.7-40.6 7.9-69.4 45.6-69.8 86.2-.1 10.5 9.3 20.5 20 20 10.9-.5 19.9-8.8 20-20 0-1.6.1-3.3.2-4.9 0-.7.1-1.4.2-2.1.3-4-.1 1.3-.2 1.2-.7-.4 2.1-9 2.4-9.8.3-.8.9-4.2 1.6-4.4.2-.1-1.8 3.7-.7 1.7.4-.8.8-1.6 1.1-2.4 1.5-3 3.3-5.7 5.1-8.5 1.9-2.9-2.7 3.1.5-.6 1-1.1 2-2.3 3.1-3.4s2.2-2.2 3.3-3.2c.5-.4 1-.9 1.5-1.3.7-.6 3.6-2 1-.9-2.2.9-.6.5.1 0s1.4-1 2.2-1.5c1.1-.7 2.2-1.4 3.4-2 1.5-.9 3.1-1.6 4.7-2.4.5-.3 2.6-1.3 0-.1-3 1.4 1-.3 1.3-.4 2.7-1 5.6-1.8 8.4-2.4.9-.2 1.8-.3 2.7-.5 2.2-.5-1.9.2-1.9.2 1.8 0 3.7-.4 5.5-.4 3.3-.1 6.5 0 9.8.3 3.7.3-3.8-.7.8.2 1.8.3 3.5.8 5.3 1.2 1.5.4 3 .9 4.5 1.4.4.1 2.4.8 2.5.9.1.3-3.7-1.9-1.7-.7 2.8 1.7 5.9 3 8.7 4.8.7.5 1.4 1 2.2 1.5.7.5 2.2.9.1 0-2-.8-.7-.6 0 .1.7.6 1.3 1.1 2 1.7 2.5 2.2 4.6 4.6 6.8 7 3 3.3-1.4-2.3.5.6.8 1.3 1.7 2.5 2.5 3.8.8 1.3 1.6 2.7 2.3 4l.9 1.8c1.9 3.6.4-.3-.1-.5 1.2.4 2.5 7.6 2.9 8.9.3 1.3.6 2.7.9 4 .8 3.8-.1-1.2-.1-1.3.5.5.3 2.8.3 3.4.2 3 .2 6.1 0 9.1-.1.9-.2 1.8-.2 2.8-.1 2-1.2 1.7.2-1.2-.7 1.5-.7 3.7-1.1 5.3-.7 2.8-1.8 5.5-2.6 8.3-.8 2.5 1.8-3.4.5-1.1-.3.5-.6 1.2-.8 1.8-.8 1.6-1.6 3.1-2.5 4.6-.8 1.3-1.6 2.6-2.5 3.9-2.7 4.1 1.9-2-.4.7-2.2 2.5-4.3 4.9-6.8 7.1-.4.4-2.8 3-3.5 3 0 0 4.1-2.8.9-.8-.6.4-1.1.7-1.6 1.1-2.8 1.8-5.7 3.3-8.6 4.8-3.1 1.6 3.6-1.2-.7.3-1.5.5-2.9 1-4.4 1.5-1.5.4-3 .8-4.6 1.2-.7.1-1.3.3-2 .4-4.4 1 3.2-.2.6 0-3.3.3-6.5.5-9.8.4-1.6 0-3.2-.2-4.9-.3-.6 0-3-.3-.1 0 3.3.3-.7-.2-1.4-.3-3.5-.7-6.9-1.8-10.3-3-.6-.2-2.6-1.2-.1 0 2.9 1.4-.6-.3-1.2-.6-1.6-.8-3.1-1.6-4.6-2.5-1.5-.9-2.9-1.9-4.4-2.9-2.4-1.5.3.8.9.8-.4 0-1.7-1.4-2-1.7-2.6-2.3-5.1-4.7-7.4-7.4 0 0-1.7-1.7-1.7-2 0 .4 2.4 3.4.8.9-1-1.5-2-2.9-2.9-4.4-1-1.7-1.9-3.5-2.8-5.2-2.1-4.1 1 3.2-.6-1.3-1.2-3.4-2.2-6.8-2.9-10.4-.1-.6-.1-1.5-.4-2 1.5 3.3.3 2.8.1.5-.2-2.1-.3-4.2-.3-6.3-.1-10.5-9.1-20.5-20-20-11.3.3-20.7 8.7-20.5 19.9zM960.8 258 839.4 571H372.9L269.7 258z"></path>
            <path d="M941.5 252.5c-13.7 35.3-27.3 70.6-41 105.9-21.8 56.3-43.6 112.5-65.3 168.8-5 12.9-10 25.9-15 38.8 6.4-4.9 12.9-9.8 19.3-14.7H430.4c-18.8 0-37.8-.8-56.7 0h-.8c6.4 4.9 12.9 9.8 19.3 14.7-11.7-35.5-23.3-70.9-35-106.4-18.5-56.1-37-112.2-55.4-168.4-4.3-12.9-8.5-25.8-12.8-38.8-6.4 8.4-12.9 16.9-19.3 25.3H932.8c9 0 18 .2 26.9 0h1.2c10.5 0 20.5-9.2 20-20s-8.8-20-20-20H297.8c-9 0-18-.2-26.9 0h-1.2c-12.5 0-23.4 12.9-19.3 25.3 11.7 35.5 23.3 70.9 35 106.4 18.5 56.1 37 112.2 55.4 168.4 4.3 12.9 8.5 25.8 12.8 38.8 2.8 8.4 10.2 14.7 19.3 14.7H782c18.8 0 37.8.7 56.7 0h.8c9.5 0 16.1-6.4 19.3-14.7 13.7-35.3 27.3-70.6 41-105.9 21.8-56.3 43.6-112.5 65.3-168.8 5-12.9 10-25.9 15-38.8 3.8-9.8-4.2-22.4-14-24.6-11.5-2.6-20.6 3.5-24.6 14z"></path>
          </svg>
          <span className="total__items-in_cart">
            {prodCounter > 99 ? "99+" : prodCounter}
          </span>
        </div>
      </h2>

      {cartItems.length == 0 ? (
        <p className="cart__empty">Your Cart is Empty!</p>
      ) : (
        <ul className="cart__item-container">
          {cartItems.map((item, index) => (
            <div className="cart__item" key={index}>
              <div className="item__detail">
                <img src={item.img} alt={index.name} />
                <div className="disc">
                  <li className="item__name-price">
                    {item.name} - {item.price}
                  </li>
                  <li className="item__description">{item.description}</li>
                  <div className="qty__control">
                    {item.quantity === 1 ? (
                      <button
                        className="remove__from-cart"
                        onClick={() => removeCartItem(index)}
                      >
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          width="30"
                          height="30"
                          fill="none"
                          viewBox="0 0 24 24"
                          id="trash-bin-minimalistic"
                        >
                          <path
                            fill="#fff"
                            fillRule="evenodd"
                            d="M11.9999 2.75C11.0214 2.75 10.187 3.37503 9.87778 4.24993 9.73974 4.64047 9.31125 4.84517 8.92071 4.70713 8.53018 4.56909 8.32548 4.1406 8.46352 3.75007 8.97796 2.29459 10.366 1.25 11.9999 1.25 13.6339 1.25 15.0219 2.29459 15.5364 3.75007 15.6744 4.1406 15.4697 4.56909 15.0792 4.70713 14.6886 4.84517 14.2601 4.64047 14.1221 4.24993 13.8129 3.37503 12.9784 2.75 11.9999 2.75zM2.74991 6C2.74991 5.58579 3.08569 5.25 3.49991 5.25H20.5C20.9142 5.25 21.25 5.58579 21.25 6 21.25 6.41421 20.9142 6.75 20.5 6.75H3.49991C3.08569 6.75 2.74991 6.41421 2.74991 6zM5.11677 7.75166C5.53007 7.72411 5.88744 8.03681 5.915 8.45011L6.37494 15.3492C6.4648 16.6971 6.52882 17.6349 6.66939 18.3405 6.80574 19.025 6.99607 19.3873 7.26949 19.6431 7.5429 19.8988 7.91706 20.0647 8.60906 20.1552 9.32246 20.2485 10.2625 20.25 11.6133 20.25H12.3867C13.7375 20.25 14.6775 20.2485 15.3909 20.1552 16.0829 20.0647 16.4571 19.8988 16.7305 19.6431 17.0039 19.3873 17.1942 19.025 17.3306 18.3405 17.4712 17.6349 17.5352 16.6971 17.625 15.3492 17.6526 14.9359 18.01 14.6232 18.4233 14.6508 18.8366 14.6783 19.1493 15.0357 19.1217 15.449L19.1182 15.5016C19.0327 16.7844 18.9637 17.8205 18.8017 18.6336 18.6333 19.4789 18.3469 20.185 17.7553 20.7384 17.1637 21.2919 16.4401 21.5307 15.5855 21.6425 14.7634 21.75 13.725 21.75 12.4394 21.75H11.5606C10.275 21.75 9.23654 21.75 8.41451 21.6425 7.55985 21.5307 6.83631 21.2919 6.24471 20.7384 5.65312 20.185 5.3667 19.4789 5.1983 18.6336 5.03632 17.8205 4.96727 16.7844 4.88177 15.5016L4.41832 8.54989C4.39077 8.13659 4.70347 7.77921 5.11677 7.75166zM18.8832 7.75166C19.2965 7.77921 19.6092 8.13659 19.5817 8.54989L19.3817 11.5499C19.3541 11.9632 18.9967 12.2759 18.5834 12.2483 18.1701 12.2208 17.8574 11.8634 17.885 11.4501L18.085 8.45011C18.1125 8.03681 18.4699 7.72411 18.8832 7.75166z"
                            clipRule="evenodd"
                          ></path>
                          <path
                            fill="#fff"
                            fillRule="evenodd"
                            d="M9.42536 10.2537C9.83752 10.2125 10.2051 10.5132 10.2463 10.9254L10.7463 15.9254C10.7875 16.3375 10.4868 16.7051 10.0746 16.7463 9.66246 16.7875 9.29493 16.4868 9.25371 16.0746L8.75371 11.0746C8.7125 10.6625 9.01321 10.2949 9.42536 10.2537zM14.5746 10.2537C14.9868 10.2949 15.2875 10.6625 15.2463 11.0746L14.7463 16.0746C14.7051 16.4868 14.3375 16.7875 13.9254 16.7463 13.5132 16.7051 13.2125 16.3375 13.2537 15.9254L13.7537 10.9254C13.7949 10.5132 14.1625 10.2125 14.5746 10.2537z"
                            clipRule="evenodd"
                          ></path>
                        </svg>
                      </button>
                    ) : (
                      <button
                        onClick={() =>
                          updateQuantity(index, Math.max(1, item.quantity - 1))
                        }
                        className="sub__item"
                        disabled={item.quantity === 1 ? true : false}
                      >
                        -
                      </button>
                    )}

                    <input
                      type="text"
                      value={item.quantity}
                      className="item__qty"
                      onChange={(e) => {
                        updateQuantity(
                          index,
                          Math.max(1, parseInt(e.target.value))
                        );
                      }}
                    />
                    <button
                      onClick={() => updateQuantity(index, item.quantity + 1)}
                      className="add__item"
                    >
                      +
                    </button>
                  </div>
                </div>
              </div>
              <button
                className="remove__from-cart"
                onClick={() => removeCartItem(index)}
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="30"
                  height="30"
                  fill="none"
                  viewBox="0 0 24 24"
                  id="trash-bin-minimalistic"
                >
                  <path
                    fill="#fff"
                    fillRule="evenodd"
                    d="M11.9999 2.75C11.0214 2.75 10.187 3.37503 9.87778 4.24993 9.73974 4.64047 9.31125 4.84517 8.92071 4.70713 8.53018 4.56909 8.32548 4.1406 8.46352 3.75007 8.97796 2.29459 10.366 1.25 11.9999 1.25 13.6339 1.25 15.0219 2.29459 15.5364 3.75007 15.6744 4.1406 15.4697 4.56909 15.0792 4.70713 14.6886 4.84517 14.2601 4.64047 14.1221 4.24993 13.8129 3.37503 12.9784 2.75 11.9999 2.75zM2.74991 6C2.74991 5.58579 3.08569 5.25 3.49991 5.25H20.5C20.9142 5.25 21.25 5.58579 21.25 6 21.25 6.41421 20.9142 6.75 20.5 6.75H3.49991C3.08569 6.75 2.74991 6.41421 2.74991 6zM5.11677 7.75166C5.53007 7.72411 5.88744 8.03681 5.915 8.45011L6.37494 15.3492C6.4648 16.6971 6.52882 17.6349 6.66939 18.3405 6.80574 19.025 6.99607 19.3873 7.26949 19.6431 7.5429 19.8988 7.91706 20.0647 8.60906 20.1552 9.32246 20.2485 10.2625 20.25 11.6133 20.25H12.3867C13.7375 20.25 14.6775 20.2485 15.3909 20.1552 16.0829 20.0647 16.4571 19.8988 16.7305 19.6431 17.0039 19.3873 17.1942 19.025 17.3306 18.3405 17.4712 17.6349 17.5352 16.6971 17.625 15.3492 17.6526 14.9359 18.01 14.6232 18.4233 14.6508 18.8366 14.6783 19.1493 15.0357 19.1217 15.449L19.1182 15.5016C19.0327 16.7844 18.9637 17.8205 18.8017 18.6336 18.6333 19.4789 18.3469 20.185 17.7553 20.7384 17.1637 21.2919 16.4401 21.5307 15.5855 21.6425 14.7634 21.75 13.725 21.75 12.4394 21.75H11.5606C10.275 21.75 9.23654 21.75 8.41451 21.6425 7.55985 21.5307 6.83631 21.2919 6.24471 20.7384 5.65312 20.185 5.3667 19.4789 5.1983 18.6336 5.03632 17.8205 4.96727 16.7844 4.88177 15.5016L4.41832 8.54989C4.39077 8.13659 4.70347 7.77921 5.11677 7.75166zM18.8832 7.75166C19.2965 7.77921 19.6092 8.13659 19.5817 8.54989L19.3817 11.5499C19.3541 11.9632 18.9967 12.2759 18.5834 12.2483 18.1701 12.2208 17.8574 11.8634 17.885 11.4501L18.085 8.45011C18.1125 8.03681 18.4699 7.72411 18.8832 7.75166z"
                    clipRule="evenodd"
                  ></path>
                  <path
                    fill="#fff"
                    fillRule="evenodd"
                    d="M9.42536 10.2537C9.83752 10.2125 10.2051 10.5132 10.2463 10.9254L10.7463 15.9254C10.7875 16.3375 10.4868 16.7051 10.0746 16.7463 9.66246 16.7875 9.29493 16.4868 9.25371 16.0746L8.75371 11.0746C8.7125 10.6625 9.01321 10.2949 9.42536 10.2537zM14.5746 10.2537C14.9868 10.2949 15.2875 10.6625 15.2463 11.0746L14.7463 16.0746C14.7051 16.4868 14.3375 16.7875 13.9254 16.7463 13.5132 16.7051 13.2125 16.3375 13.2537 15.9254L13.7537 10.9254C13.7949 10.5132 14.1625 10.2125 14.5746 10.2537z"
                    clipRule="evenodd"
                  ></path>
                </svg>
              </button>
            </div>
          ))}
        </ul>
      )}
    </div>
  );
};

export default Cart;
